/* Markdown prose styles */
.prose {
  @apply text-black;

  :not(table):not(div):not(main):not(section):not(article),
  .prose-aside,
  *.with-max-w,
  hr,
  img {
    @apply max-w-5;
  }

  table tr :not(.prose-table):not(.prose-codeblock):not(div):not(main):not(section):not(article) {
    @apply max-w-5;
  }

  *:not(h1) + h2 {
    @apply mt-10;
  }

  *:not(h2) + h3,
  *:not(h3) + h4 {
    @apply mt-9;
  }

  *:not(h4) + h5,
  *:not(h5) + h6 {
    @apply mt-8;
  }

  * + blockquote {
    @apply mt-9;
  }

  * + p,
  * + ul,
  * + ol,
  * + img,
  * + .prose-aside,
  * + .prose-codeblock,
  * + .with-mt {
    @apply mt-5;
  }

  * + .prose-table {
    @apply mt-7;
  }

  h1::after,
  hr {
    content: '';
    @apply block rounded-full h-2px bg-primary-700;
  }

  hr {
    @apply w-1/3 min-w-4 my-16;
  }

  h1::after {
    @apply w-12 mt-6;
  }

  h1 {
    @apply text-7 font-700 leading-0 text-gray-800;
  }

  h2 {
    @apply text-5 mb-6 font-500 text-gray-900;

    code {
      @apply text-4;
    }
  }

  h3 {
    @apply text-4 mb-5 font-300 text-gray-900;

    code {
      @apply text-3;
    }
  }

  h4 {
    @apply text-3 mb-5 font-600 tracking-1 text-gray-900;

    code {
      @apply text-2;
    }
  }

  h5 {
    @apply text-2 mb-3 font-600 tracking-1 text-gray-900;

    code {
      @apply text-1;
    }
  }

  p {
    @apply text-3 leading-2;
  }

  em {
    @apply italic;
  }

  blockquote::before {
    content: '\201C';
    @apply absolute text-9 text-primary-900 opacity-70 top-0 left-0 -mt-1/2em;
  }

  blockquote {
    @apply relative pl-6 pr-4 py-3 rounded mb-8 text-6 font-600 tracking-1 bg-white shadow-1 text-gray-700;
  }

  ul,
  ol {
    li {
      @apply relative pl-8 leading-2;

      p {
        @apply mt-3;
      }
    }

    * + li {
      @apply mt-2;
    }

    li::before {
      @apply absolute left-0 ml-2 text-3 text-primary-900;
    }
  }

  * + ul,
  * + ol {
    ul,
    ol {
      @apply mt-3
    }
  }

  ul {
    > li::before {
      content: '\2022';
      @apply text-5 -mt-1;
    }

    li {
      > ul > li::before {
        content: '\25E6';
        @apply text-3;
      }
    }
  }

  ol {
    > li::before {
      content: counter(item)'.';
    }

    li {
      counter-increment: item;

      > ol > li::before {
        content: counter(item, lower-roman)'.';
      }
    }
  }

  img {
    @apply w-full rounded shadow-2;
  }

  :not(.prose-heading) > a:not(.btn) {
    @apply text-primary-700 no-underline;

    &:visited {
      @apply text-primary-500;
    }

    &:hover {
      @apply underline;
    }
  }

  .prose-codeblock {
    @apply rounded p-3 overflow-x-scroll -shadow max-h-2/3-screen scrolling-touch;

    code {
      @apply leading-1 bg-inherit;
    }
  }

  :not(pre) > code,
  kbd {
    @apply rounded py-px px-1 tracking-1;
  }

  :not(pre) > code {
    @apply bg-gray-200;
  }

  :not(h1):not(h2):not(h3):not(h4):not(h5):not(h5) > code {
    @apply text-1;
  }

  .scrollable {
    @apply scrolling-touch overflow-x-scroll -shadow;
  }

  .prose-table {
    @apply max-w-full mb-6 inline-block;

    .contents {
      @apply max-h-2/3-screen;

      [role="grid"] {
        @apply w-full;
        display: table;
      }

      [role="rowgroup"] {
        display: table-row-group;
      }

      [role="rowgroup"]:first-child {
        @apply rounded-2;
        display: table-header-group;
      }

      [role="row"] {
        display: table-row;

        &:last-child {
          @apply border-b-1 border-gray-300;
        }
      }

      [role="columnheader"] {
        @apply py-2 text-1 font-600 uppercase tracking-1 bg-primary-100 text-primary-900;

        code {
          @apply bg-primary-200 normal-case;
        }
      }

      [role="columnheader"],
      [role="gridcell"] {
        @apply text-left px-5 align-top;
        display: table-cell;
      }

      [role="gridcell"] {
        @apply py-4 leading-2 border-l border-gray-300;

        &:last-child {
          @apply border-r;
        }
      }
    }

    &.prose-table-striped {
      .contents {
        [role="rowgroup"] > :nth-child(even) {
          @apply bg-gray-100;

          &:last-child {
            @apply border-gray-400;
          }

          [role="gridcell"] {
            @apply border-gray-400;

            code {
              @apply bg-gray-300;
            }
          }
        }
      }
    }
  }

  .prose-aside {
    @apply relative flex items-start rounded-r-1 p-5 my-6 border-l-4;

    .aside-header {
      @apply flex items-center;
    }

    .aside-icon {
      @apply absolute -left-2px -translate-x-50 h-7 w-7 rounded-full p-1;
    }

    &.aside-info {
      @apply border-blue-500 bg-blue-100 text-blue-900;

      &::before {
        background-image: linear-gradient(to bottom, theme(colors.blue-500) 0%, theme(colors.blue-500) 1.5rem, theme(colors.white) 1.5rem, theme(colors.white) 3rem, theme(colors.blue-500) 3rem, theme(colors.blue-500) 110%);
      }

      .aside-icon {
        @apply bg-blue-500 text-blue-100;
      }

      code,
      kbd {
        @apply bg-blue-200;
      }

      a {
        @apply text-blue-700 font-600;
      }

      li::before {
        @apply text-blue-700;
      }
    }

    &.aside-warning {
      @apply border-yellow-500 bg-yellow-100 text-yellow-900;

      &::before {
        background-image: linear-gradient(to bottom, theme(colors.yellow-500) 0%, theme(colors.yellow-500) 1.5rem, theme(colors.white) 1.5rem, theme(colors.white) 3rem, theme(colors.yellow-500) 3rem, theme(colors.yellow-500) 110%);
      }

      .aside-icon {
        @apply bg-yellow-500 text-yellow-100;
      }

      code,
      kbd {
        @apply bg-yellow-200;
      }

      a {
        @apply text-yellow-700 font-600;
      }

      li::before {
        @apply text-yellow-700;
      }
    }

    &.aside-danger {
      @apply border-red-500 bg-red-100 text-red-900;

      &::before {
        background-image: linear-gradient(to bottom, theme(colors.red-500) 0%, theme(colors.red-500) 1.5rem, theme(colors.white) 1.5rem, theme(colors.white) 3rem, theme(colors.red-500) 3rem, theme(colors.red-500) 110%);
      }

      .aside-icon {
        @apply bg-red-500 text-red-100;
      }

      code,
      kbd {
        @apply bg-red-200;
      }

      a {
        @apply text-red-700 font-600;
      }

      li::before {
        @apply text-red-700;
      }
    }

    &.aside-success {
      @apply border-green-500 bg-green-100 text-green-900;

      &::before {
        background-image: linear-gradient(to bottom, theme(colors.green-500) 0%, theme(colors.green-500) 1.5rem, theme(colors.white) 1.5rem, theme(colors.white) 3rem, theme(colors.green-500) 3rem, theme(colors.green-500) 110%);
      }

      .aside-icon {
        @apply bg-green-500 text-green-100;
      }

      code,
      kbd {
        @apply bg-green-200;
      }

      a {
        @apply text-green-700 font-600;
      }

      li::before {
        @apply text-green-700;
      }
    }
  }
}

@media screen and (min-width: theme('screens.md')) {
  .prose {
    .prose-codeblock,
    .prose-table .contents {
      @apply max-h-full;
    }

    blockquote {
      @apply pl-8 pr-6;
    }

    h1 {
      @apply text-7;

      code {
        @apply text-6;
      }
    }

    h2 {
      @apply text-6;

      code {
        @apply text-5;
      }
    }

    h3 {
      @apply text-5;

      code {
        @apply text-4;
      }
    }

    h4 {
      @apply text-4;

      code {
        @apply text-3;
      }
    }

    h5 {
      @apply text-3;

      code {
        @apply text-2;
      }
    }

    p {
      @apply text-3;
    }

    blockquote::before {
      @apply text-10;
    }

    blockquote {
      @apply text-7;
    }

    li::before {
      @apply text-4;
    }

    :not(h1):not(h2):not(h3):not(h4):not(h5):not(h5) > code {
      @apply text-2;
    }

    th {
      @apply text-2;
    }
  }
}
